# Clostridium Scindens Mining

### Download Genomes
Genomes from human gut microbiome datasets were downloaded from nine different sources. 32,277 genomes were downloaded from Zeng et al. 2022, 1,200 genomes from Wilkinson et al. 2020, 120 genomes from Almeida et al. 2020, 1,381 genomes from Tamburini et al. 2021, 154,723 genomes from Pasolli et al. 2019, 4,997 genomes from Merrill et al. 2022, 2,914 genomes from Lemos et al. 2022, 4,497 genomes from Gounot et al. 2022, and 31 genomes from NCBI. The GTDB-Tk (version 2.1.1) classify workflow (classify_wf) was run on all 202,140 genomes, which resulted in the identification of 224 _Clostridium scindens_ genomes. From these 224 genomes, 66 genomes were obtained after running the dRep (version 3.4.0) dereplicate workflow (-comp 50 -pa 0.99 -sa 0.99). 

### Generate HMM Profiles
Experimentally-verified amino acid sequences for the proteins BaiA_2, BaiCD, BaiE, BaiF, BaiG, BaiH, BaiI, BaiJ, BaiK, BaiN, BaiP, DesA, DesB, 12alpha-HSDH, 12beta-HSDH, 3alpha-HSDH, 3beta-HSDH, 7alpha-HSDH, and 7beta-HSDH were used to generate HMM profiles. In order to create the protein-protein alignments needed to generate HMM profiles, muscle (5.1.linux64) was used with default parameters to align all amino acid sequences for each of the proteins. This aligment was converted to stockholm format using the esl-reformat function of the Easel package (version 0.48). The alignments were then used with the hmmbuild function of the HMMER (version 3.3.2) package to generate the HMM profiles. 

### Create Trusted Cutoffs
To generate trusted cutoffs for each of the proteins, one amino acid sequence for each of the proteins was extracted and queried against the NCBI nr protein database using the NCBI blastp suite. For each protein, the sequences for the top 500 hits from the BLAST output were downloaded. The previously-generated HMM profiles were queried against the obtained BLAST sequences for each protein sequence using hmmsearch with default parameters. The score used as a trusted cutoff was identified based on the largest changes in score from the hmmsearch outputs. The average of the two scores that constitute the largest drop in number were averaged to generate the trusted cutoffs. For 12alpha-HSDH, there was no clear large drop in score identified from the hmmsearch outputs, so no trusted cutoff was added to the HMM profile. For BaiH and BaiB, there were two large drops in score consecutively, so these three score values were averaged to generate the trusted cutoff. 

### Identify Protein Sequences in _C. scindens_ Genomes
The 224 identified _C. scindens_ genomes were translated into amino acid sequences using Prodigal (version 2.6.3). The generated HMM profiles were queried against the amino acid sequences for the 224 genomes using hmmsearch of the HMMER package with the flag --cut_tc. 
